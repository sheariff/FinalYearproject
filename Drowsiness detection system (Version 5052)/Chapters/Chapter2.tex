\chapter{Background}
\label{chap:background}
\lhead{\emph{Background}}


Previous research on drowsiness detection was focused primarily on the lane deviation but due to to how late this detection was carried out the focus was changed to a more moderate solution that would try to detect the drowsiness of an individual well before an accident would occur, now that technology has advanced researchers are able to identify when a driver behind the wheel has become drowsy as the advancement in technology has allowed for precise detection of the symptoms that are exhibited when an individual behind the wheel starts to feel drowsy such as the bopping of the head, heart rate slowing down their eyes starting to feel heavy.

The leading cause of work related fatalities are driving related jobs. This is a big issue that corporations and road safety campaigners are trying to solve, due to the improvement in technology that we have access too we are able to develop technologies that can very accurately detect the symptoms associated with drowsiness.

Today we live in a world that is dictated by technology, this has resulted in tasks becoming much easier to accomplish - such as the ability to communicate with other people around the world, more information gets passed around much quicker. Applications have been on the rise since the introduction of the smartphone and so has fast food application. These application have resulted in a increase of fast food drivers especially in countries such as china who have seen a boom in food delivery couriers delivering food by scooters there has also been a increase in road accidents due to this. 

 
\section{Thematic Area within Computer Science}

The concrete topic that will be looked at here is how Drowsiness behind the wheel can be detected in a manner that is effective and reliable in the hope to increase the safety of drivers and workers behind the wheel who have been driving 
while also feeling sleepy, the aim is to detect when they have started to feel sleepy and to signal them to wake up. This is accomplished through eye tracking technology that would find behavioral signs that the driver may be exhibiting that are related to the drowsy driver, Making this a system that is very reliable is the main goal of the project. Using a small camera  the cost of this system will be minimized but cost effective for the user who uses the technology in their car. The camera can be placed in front of the driver just above him so that it doesn't obstruct his field of view while he is driving also maintaining the reliability that the camera will work effectively in catching drowsiness as they are driving their vehicle
  
The core Area this project falls under within computer science is as a embedded application. The software is the core of this system as it will run the functionality needed for the camera to perform the tasks needed by the user. The software will carry out all the operations such as  the driver while the camera while be responsible with detecting the driver when he starts feeling sleepy behind the wheel.

The main area this project falls under is embedded engineering.
\textbf{
\section{Project scope}
}
\textbf{Embedded applications}

Embedded applications are software applications that permanently reside within a device, providing some type of control function or user interface. The software is currently stored within the read only memory (ROM) or within flash memory. The reason why software get stored in the ROM is because if for any chance the power supply to the device is stopped for whatever reason then the application that is embedded within the device will not get erased and will still be available to run the functionality that was intended, so to makes things simple ROM stores the program code while the random access memory (RAM) stores the transient input and output data. Embedded applications are in nearly every piece of hardware that we use and can be very complicated or very simple depending on the function that the hardware has to carry out, some small embedded applications such as the ones inside a microwave don't require a operating system to control them, other more complex systems such as entertainment systems that are in control of a multitude of channels and are expected to record and play videos from a large and wide range of devices will need an operating system to manage the resources in real time. Real time Embedded systems are thing such as a GPS navigating system (Global Positioning System), industrial robots, traffic monitoring system, smart phones and smart TV's all of these embedded system all have applications dictating the functionality of these devices.

Embedded versions of popular operating systems like Linux, Windows and Mac are available, along with some specialized OSes. They will usually have reduced storage needs and will work with less RAM than a desktop OS. The program instructions for embedded systems are called firmware, or embedded software. Embedded software is typically very easy on hardware resources â€“ requiring little memory and often needing no keyboard or screen. The embedded software is not controlled by human interfaces, but rather by machine interfaces.
In this project a small  camera will be used, any computer has a built in front facing camera and this will be the hardware used to analyse the eye closure rate of the driver. This will be the embedded hardware used in the project. The camera will constantly take images so that it can compare the images with previous images that are stored in a database.    

\textbf{Background operations}
In the background there will be an application running that will track the eye movement of the driver. Thanks to readily available open sourced eye tracking software and libraries that is easily available to download from the internet, we have access to useful tools that are will work in conjunction with the camera to detect drowsiness. The use of the Python language adds another advantage in the fact that its the most used language in the world this has resulted in a wide range of libraries and technologies that can works with this programming language.  Using Python to communicate with embedded systems
Python scripts can put the system into different states, set configurations, and test all sorts of real-world use cases. Python can also be used to receive embedded system data that can be stored for analysis this is essential within the project as the project has a huge analytical importance that will determine the applications success, using a programming language that fits well within the boundaries of the projects goals will be essential in achieving the unique goals and tasks that this project requires. 

\textbf{PyGaze and OpenCV}
The Python Supports many open source eye tracking technologies, PyGaze is a open sourced toolbox for eye tracking in python it also has two accompanying features  PyGaze analyser and webcam eye-tracker, PyGaze will be useful in analyzing the users eye movement such as the what the user is looking at within that particular moment if he is fixated on something or is shifting his gaze elsewhere. Using the information that is gathered from the the open source software we can then trigger the event detection methods that are within the python script to help use form a conclusion. The methods within PyGaze will be the main method used to gather information about the user, such as the direction of there gaze and eye lid distance for determining events such as if the user has stopped looking at the road and his gaze has gone downwards accompanied by his eyes shutting signally sleepiness.the benefit that this open source technology brings is that it is very accurate as it has been tried and tested. 

OpenCV is an open source computer vision and machine learning software library. OpenCV was built to provide a common infrastructure for computer vision applications and to accelerate the use of machine perception in the commercial products.The library has more than 2500 optimized algorithms, which includes a comprehensive set of both classic and state-of-the-art computer vision and machine learning algorithms. These algorithms can be used to detect and recognize faces, identify objects, classify human actions in videos, track camera movements, track moving objects, extract 3D models of objects, produce 3D point clouds from stereo cameras, stitch images together to produce a high resolution image of an entire scene, find similar images from an image database, remove red eyes from images taken using flash, follow eye movements, recognize scenery and establish markers to overlay it with augmented reality. OpenCV will be used in conjunction with PyGaze, it will analyse the data received by the PyGaze and run it through set algorithms in order to detect any abnormalities that may be occurring to the user my be exhibition that may lead to a successful and accurate detection.

\textbf{Machine Learning Techniques}
Machine learning techniques and algorithms must be used in this project in order to fulfill the tasks that are required of this projects, these techniques may range from the Haar cascade classifier algorithm to multiple other automatic classifier algorithms. These algorithms will be primarily pattern algorithms that will help the camera detect drowsiness, the cascade classifiers are excellent algorithms and are perfect for this type of project because the cascade function is trained from a lot of positive and negative images. It is then used to detect objects in other images. Initially, the algorithm needs a lot of positive images (images of faces) and negative images (images without faces) to train the classifier. Then we need to extract features from it, this is tedious but an effective method to detect facial features such as eyes. The core of these techniques imply use probability factors to determine whether an alert should be raised.  These problems are  classified  between  classification,  regression,  clustering  and  distribution. This project will mainly deal with classification based machine learning algorithms some regression based algorithms may be used to determine if the user is drowsy from the data. They are built up over time using time-series analysis, where the algorithm adapts and evolves as new information is fed to it. The images that are fed to the cascade classifier must be taught slowly on how to detect eyes by slowly introducing new features to the algorithm from faces to eyes, we do this by slowly introducing new areas of the face. The machine learns to detect new faces by using a positive value for images with a face and a negative value for images without a face, eventually the machine will be able able to detect certain features after gradually working the algorithm to the target feature that is desired. In the case of this project the target feature will be the eyes.

\textbf{Human computer interaction}
Human-computer interaction (HCI) is a multidisciplinary field of study focusing on the design of computer technology and, in particular, the interaction between humans (the users) and computers. While initially concerned with computers, HCI has since expanded to cover almost all forms of information technology design. The interaction that the user will have with the camera is important because it must be in a manner will allow the camera to successfully gain the data from the user and for the user to benefit from the camera in a way of preventing him from falling asleep. This interaction is essential for this project to be successful in achieving its goals. This is the essence of HCI, having the best form of interaction between the embedded device and the user will help achieve the users needs

\section{A Review of -INSERT THEMATIC AREA-}

  \textbf{Eye Tracking technology to detect drowsiness}
               
Eye Tracking System to track Driver drowsiness by Nguyen, T.P. and Chew, Moi Tin and Demidenko, S.N. \cite{article} This study focuses on analysing the available algorithms and the techniques so that eye detection rate can be as accurate as possible The conclusion was that a viola Jones and Perclos method both achieved the highest eye detection rate. 

Real Time Eye Tracking and Detection-A Driving    Assistance System by Said, Sherif and Beyrouthy, Taha and Hassan, Murtaza and Fayek, M and Al Kork, Samer, \cite{reference2} This study focuses on a driver attention while behind the wheel using eye tracking technology and a wearable bracelet, a in-vehicle  information systems is also used to monitor when the driver gets distracted behind the wheel.

Drowsiness Detection System for Pilots by Muniyandi, Manivannan and Singh, Gurpreet    \cite{inbook} This study discusses primarily on how to detect when an individual is showing signs of sleep-onset while using non intrusive methods. The study uses individuals pupil diameter while keeping a threshold deviation of +5 for both pupils. The scope of the paper was to evaluate algorithm which  was  used to  separate out  the  events which  are encountered  while  monitoring  the  eye pupil  of a  subject.  

Real-time monitoring of driver drowsiness on mobile platforms using 3D neural networks by Jasper S. Wijnands, Jason Thompson, Kerry A. Nice, Gideon D. P. A. Aschwanden, Mark Stevenson \cite{study} This study discusses the possibility of bringing a drowsy detection system to mobile phones by application using a 3D neural network, It discuses how the application was built and the issues it tackled developing the application to provide an accurate system.


\textbf{wearable devices }
 Electrodermal Activity Based Wearable Device for Drowsy Drivers by Malathi, D and Jayaseeli, Dorathi and Madhuri, S and  Senthilkumar, K.     \cite{article2 } This article looks at monitoring the skin using a wearable device in order to evaluate if a individual is is starting to feel drowsy due to the sweat levels that the body is releasing. The main goal of of this study it to determine the mental state of a driver at a given time by monitoring the brains subconscious activities such as sweat being released from the sweat glands in the skin.
 

\textbf{ Journals}
Smart Real-Time Video Surveillance Platform for Drowsiness Detection Based on Eyelid Closure by Muhammad Tayab Khan,1 Hafeez Anwar,2 Farman Ullah,2 Ata Ur Rehman,2 Rehmat Ullah,3 Asif Iqbal,4 Bok-Hee Lee,5 and Kyung Sup Kwak4\cite{journal} This article sets out by trying to establish drowsiness detection by using the drivers eyelids and the curvature of the eyelids using sobel operators and also the viola-jones algorithms. 

\textbf{Blogs}
Real time Driver Drowsiness Detection (Sleep Detection) by Taha Emara\cite{blog1} This blog discusses Dlib, a c++ toolkit and can be used for python projects also. This blog discusses how this toolkit is excellent for Drowsiness detection as it provides landmarks points that outline the eyes and face, each eye has 12 points and these point are used to compute the eye aspect ratio to estimate the level of eye opening.

DROWSY DRIVER DETECTION SYSTEM: A NEW SAFETY FEATURE by MATTHEW C. KEEGAN\cite{blog2} This blog briefly discusses the issue of micro sleep on the road which lasts between a single milliseconds and 15 seconds and its dangers, also discusses the the work companies are doing to develop detection systems and the methods these systems are implementing, as well as discussing how in the future cars will be able to take over when the system within it detects drowsiness .

Panasonic Reveals Drowsiness Detection System to Combat Driver Fatigue by PRWK\cite{blog3} This blog discusses how Panasonic Bosch and Plessey Semiconductors will be releasing Drowsiness detection technology Panasonic will be using an in-vehicle camera to recognize, analyze, and measure the rate of a driverâ€™s blinking eyes and changes in facial expressions that may indicate fatigue, Bosch will develop a camera system similar to Panasonicâ€™s that monitors a driverâ€™s head and eye movements, posture, and body temperature to measure fatigue while Plessey Semiconductors  has developed seat sensors to monitor heart rate change, using an algorithm to monitor breathing changes consistent with fatigue to provide the driver with advanced warning before potentially feeling the effects of fatigue

\textbf{
\section{Current state of the art}
}
This segment of the paper surveys and examines the most recent advancements in connection to drowsy detection in order to decide how best to take care of the problem at hand. Luckily, an incredible amount of work has  been done  on this topic and this area looks at a wide scope of these works, including works from the above segments There is a huge amount of methods  by which drowsiness detection has been actualized so we analyze these in detail. We mean to reveal the latest improvements in the field that will take care of our concern, and talk about how different works can be based upon to actualize an answer for the current issue. Before the finish of this segment we ought to have a reasonable comprehension of what has been engaged with drowsy detection. This area is isolated into a few sub segments which portray various orders or current patterns inside the field of drowsy detection.
\textbf{
\subsection{Detection methods}
}
Currently when it comes to drowsy detection systems and to having an effective drowsy detection system there is 2 different paths that other individuals who have tried to tackle this problem have taken and that is either going by an non intrusive method such as image and video processing or a more intrusive method such as wearable like wristbands which can detect a persons sweat levels that is being released, these are methods used to analyse the brain of the individual to catch subconscious triggers that can lead to accurate detection of sleepiness, our solution will be through non intrusive means so naturally we will have to look at eye technology as a solution to this problem.
current modern techniques that are used today to solve this issue is by using eye tracking technology, the issue is finding the best techniques with this technology to have a successful system, techniques that are currently used are  eye closure
ratio, eye blinking, head position, facial expressions, and yawning. Eye tracking technology is now advanced enough to detect even the smallest deviations in the pupils of an persons eyes from a distance of 2 meters. PERCLOS method is the most frequent used metric when it comes to drowsy detection based on eye state observation at the moment. PERCLOS is the ratio of eye closure over a period and from this being able to determine if an eye is open or closed. My solution to this problem will mainly use the users eyes as a solution this projects problem. 
PERCLOS =No. frames of closed eyes/3 min interval of all frame blinking time
Yawning based detection systems are also used to detect Drowsiness and can be a very accurate method for this solution. yawning based detection systems analyse the variations of the geometric shape of the drowsy persons mouth and lip position, wider opening of the mouth on a regular basis is usually a dead give away when it comes to detection by this method.
Behavioral based techniques are used also to achieve this computer vision and a Camera is usually used to capture behavioral actions that the a person may exhibit. The current issues when using this method are usual environmental factors, such as the illumination, brightness,and road conditions influence the credibility and accuracy of measurement and this makes it very unreliable when trying to have an accurate system. \cite{ramzan2019survey}, we will delve deeper into these detection methods and see in detail how these solutions work currently.

\textbf{ EYE TRACKING AND DYNAMIC TEMPLATE MATCHING}
 When trying to avoid road accidents, a real time driver fatigue system based on vision is proposed to tackle this problem \cite{ramzan2019survey}. This solution is currently the most used solution that other individuals have tried to use to solve this issue, usually the system detects  the face of the driver from the input images using HSI (hue , saturation, intensity)color model which  decouples the intensity component from the color-carrying information(hue and saturation) in a color image. The HSI model is an ideal tool for developing image processing algorithms based on color descriptions that are natural and intuitive to humans, it then uses the sobel edge operator which sometimes called the Sobelâ€“Feldman operator or Sobel filter, is used in image processing and computer vision, particularly within edge detection algorithms where it creates an image emphasising edges \cite{ramzan2019survey}.  The Sobel edge operator is used to locate the eyes positions and gets the images of eye as the dynamic template for the tracking of eye. Then the obtained images are converted to HSI color model to decide that whether the eyes are close or open to judge the drowsiness of driver

\textbf{MOUTH AND YAWNING ANALYSIS}
Fatigue is one of the main reasons that road accident do occur to avoid this issue one of the main solutions is using facial images to detect drowsiness \cite{saradadevi2008driver} Firstly, the system locates and tracks the mouth of a driver using cascade of classifier training and mouth detection from the input images. A Haar Cascade is basically a classifier which is used to detect the object for which it has been trained for, from the source. The Haar Cascade \cite{inproceedings} is trained by superimposing the positive image over a set of negative images. The training is generally done on a server and on various stages. Then, the images of mouth and yawning are trained using SVM.  An SVM model is a representation of the examples as points in space, mapped so that the examples of the separate categories are divided by a clear gap that is as wide as possible. New examples are then mapped into that same space and predicted to belong to a category based on the side of the gap on which they fall.
SVM is used to classify the regions of mouth to detects the yawning and alerts for fatigue.\cite{yeo2009can}

\textbf{FACIAL EXPRESSIONS METHOD}
 Finite Element Analysis is used by the researchers which is a complex system that contains the database of facial expression as a template and detect the drowsiness on the basis of results from database\cite{ramzan2019survey}. The proposed solution with this type of method is to have the hardware system use in fared d light as it has giving many benefits like ease of use, independent of lightning conditions of environment. The system firstly uses the technique of background subtraction to determines the face region from the input images. Background subtraction (BS) is a common and widely used technique for generating a foreground mask (namely, a binary image containing the pixels belonging to moving objects in the scene) by using static cameras \cite{wilkinson2013accuracy}. Then using horizontal projection and template matching, facial expressions are obtained. After that in the tracking phase, elements found earlier are followed up using template matching and then investigates the incidence of sleepiness using the determination of facial states from the changes of the facial components. Changing in the three
main elements such as eye brow rising, yawning and eye closure for the certain period are taken as the initial indications for drowsiness and the system generates the alert. The facial expression method does use a combination of the other methods to achieve its task but its a more accurate method as it detects multiple types of drowsiness.\cite{ramzan2019survey} 

\textbf{EYE CLOSURE AND HEAD POSTURES METHOD} 
 At first a  video is captured using webcam and for each frame of video the following operations are performed in order to detect the face and eyes, viola-jones method is then used. The Viola-Jones algorithm is a widely used mechanism for object detection. The main property of this algorithm is that training is slow, but detection is fast. after this the face is partitioned in to three areas and the top one presenting the eye area is browsed by the Haar classifier.\cite{ramzan2019survey} if Then to detect the eye state, Wavelet Network based on neural network is used to train the images then the coefficients learning images is compared with the coefficients of the testing images and tells which class it belongs. When the closed eye is identified in the frames then the eye closure duration is calculated using PERCLOS, if the value exceeds the predefined time then the drowsiness state is detected. Then the developed system estimates the head movements which are: left, right, forward, backward inclination and left or right rotation. The captured video is segmented into frames and extract the images of head and determines the coordinates of image. Then the images are compared to determine the inclined state of head and same case with other head postures.Finally, the system combines the eye closure duration and head posture estimation to measure the drowsiness. \cite{ramzan2019survey}

{
\subsection{Machine learning algorithms}
}
Solutions to drowsy detection systems have many Machine learning algorithms as these algorithms must be used to achieve the goal of this project, Different algorithms are used to achieve different task withing the context of this project. I will be discussing the most common algorithms that are used today with this project with he modern technology that is available to use.

\textbf{ cascade classifier}
This is a machine learning object detection algorithms used to identify objects in an image or video. Its an algorithm that is very popular within the context of my project and is used very often in facial analysis solution\cite{inproceedings}.The use of the cascade classifier algorithms help the camera recognise a face from a random object in the background.One of the algorithms that is most common with this project is the Haar cascade classifier algorithm. Once   the   Haar   features   are   obtained  then  individual  classifiers  are  built  based  on  the  values  of  each  Haar  feature.  These  individual  classifiers  are  then arranged into a cascade classifier. A cascaded classifier is combination  of  several  classifiers  arranged in different  stages to cascaded on after one another. The number of classifiers in each stage and their threshold values are determined by the boosting algorithm during the training of the classifiers with labeled face images. Boosting algorithms work well with this algorithm as if helps the algorithm improve facial detection. A boosting algorithm is  family of algorithms which converts weak learner to strong learners. \cite{inproceedings1}

\textbf{SVM}
Support Vector Machine is a supervised machine learning algorithm which can be used for both classification or regression challenges. However, it is mostly used in classification problems, this algorithm is very common in drowsy detection systems also and works in sync with the Haar cascade classifier. The SVM algorithm is used to train the cascade classier on the regions of the face the individual want to analyse to carry out the function of the  project. SVM is used to classify \cite{Source1}
the regions in the image that you want to focus on, such as the eyes mouth the regions of these areas such as the eye lids or mouth geometry that is being expressed in the image.If the result of the classification indicates that the driverâ€™s eyes is closed for a predefined period of time, the eyes of the driver will be considered closed and hence an alarm will be started to alert the driver, or if the result of the classification indicates that the drivers lips are to far apart of that maybe the geometry is not normal for a  predefined period of time then the drivers lips may be considered open and the alarm will be started to alert the driver.

\textbf{PERCLOS}
This is an algorithm used in this project to measure eye closure and is very effective in achieving this.This method is very common within the fatigue detection system. PERCLOS is a drowsiness detection measure, referred to as the percentage of eyelid closure over the pupil over time and reflects slow eyelid closures or droops rather than blinks\cite{journal}, this algorithm has the highest accuracy when it comes to eye closure detection. This method is a staple when it comes to to detecting behavioral cues and one of these cues is the drowsy individuals eye closure rate.

\textbf{viola - Jones}
viola-Jones method is also very common and is used to partition images into sections, usually within the context of this project face gets partitioned into three areas and the top one presenting the eye area honed in on.The Violaâ€“Jones object detection framework is the first object detection framework to provide competitive object detection rates in real-time. within the context of this project this method work by detecting the eyes in the frame in real time. when the closed eye is detected then When the closed eye is identified in the frames then the eye closure duration is calculated, if the value exceeds the
predefined time then the drowsiness state is detected.\cite{teyeb2014drowsy} Head posture doesn't matter as this algorithm is able to  take constant sample from the individual and test it with the previous images regardless of the posture that the user is expressing.



